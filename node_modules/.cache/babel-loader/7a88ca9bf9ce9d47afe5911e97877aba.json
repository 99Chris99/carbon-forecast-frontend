{"ast":null,"code":"import _toConsumableArray from\"/Users/Chris/Development/Final-Project/carbon-forecast-frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/Users/Chris/Development/Final-Project/carbon-forecast-frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/Chris/Development/Final-Project/carbon-forecast-frontend/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/Chris/Development/Final-Project/carbon-forecast-frontend/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/Chris/Development/Final-Project/carbon-forecast-frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/Chris/Development/Final-Project/carbon-forecast-frontend/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import{LineSeries,HorizontalGridLines,FlexibleXYPlot,LabelSeries}from'react-vis';import{Table,Dimmer,Loader}from'semantic-ui-react';import{withScroll}from'react-window-decorators';// @withScroll\nvar Timeline=/*#__PURE__*/function(_Component){_inherits(Timeline,_Component);function Timeline(){var _getPrototypeOf2;var _this;_classCallCheck(this,Timeline);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(Timeline)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={rawData:[{y:0,x:0,label:'loading | loadidng'}],barPosition:{date:'',offset:0},labelData:[{lable:'Testing'}],height:50,middle:typeof _this.props.middle!=='undefined'?_this.props.mediumLevel:150,value:null,// scrollCount: 0,\ninitalScrollCounter:0,dataIndex:-1,position:_this.props.scrollPositionY,scrollPlots:[],getLevel:0,yOffset:0,currentLevel:{level:0,time:'loading',text:'loading'}};_this.calYOffset=function(){var stickyTop=document.querySelector('#sticky');var stickyTopVals=stickyTop.getBoundingClientRect();// console.log(stickyTopVals)\nvar girdPlotTop=document.querySelector('.rv-xy-plot__grid-lines');var girdPlotTopVals=girdPlotTop.getBoundingClientRect();// console.log(girdPlotTopVals)    \nvar girdPlotOuterTop=document.querySelector('.rv-xy-plot__inner');var girdPlotOuterTopVals=girdPlotOuterTop.getBoundingClientRect();// console.log(girdPlotOuterTopVals)\nvar valA=stickyTopVals.top;var valB=girdPlotTopVals.top-girdPlotOuterTopVals.top;var output=valA+valB-2;//109\n_this.setState({yOffset:output});return output;};_this.chartGap=function(){var chartTop=document.querySelector('.rv-xy-plot__grid-lines');// console.log('clientHeight '+ chartTop.clientHeight )\nvar height=chartTop.getBoundingClientRect();//    console.log(height)\nvar output=height.height/_this.state.rawData.length;// console.log(output)\nreturn output;};_this.scrollPlots=function(){setTimeout(function(){return _this.calYOffset();},300);setTimeout(function(){var gap=_this.chartGap();// console.log(gap)\nvar scrollPlots=_this.props.timelineVals.map(function(point,index){var data={time:\"\".concat(_this.parseDate(point.from,'time'),\" \").concat(_this.parseDate(point.from,'date')),y:gap*index+index/2,level:point.level,text:point.text};return data;});_this.setState({scrollPlots:scrollPlots});},400);};_this.getLevel=function(){if(_this.state.scrollPlots.length>1){var currY=_this.props.scrollPositionY-_this.state.yOffset;var newArray=_this.state.scrollPlots.map(function(obj){return obj.y;});var closest=newArray.reduce(function(prev,curr){return Math.abs(curr-currY)<Math.abs(prev-currY)?curr:prev;});var found=_this.state.scrollPlots.find(function(obj){return obj.y===closest;});return _this.setState({currentLevel:{level:found.level,time:found.time,text:found.text}});}//return found.level \n};_this.parseDate=function(input,timeOrDate){var output=0;var optionsDate={weekday:'short',day:'numeric',month:'numeric'};var optionsTime={hour:'numeric',minute:'numeric',hour12:true};var options24={hour:'numeric',minute:'numeric',hour12:false};var parsedDate=new Date(Date.UTC(parseInt(input.slice(0,4),10),parseInt(input.slice(5,7),10)-1,parseInt(input.slice(8,10),10),parseInt(input.slice(11,13),10),parseInt(input.slice(14,16),10)//parseInt(input.slice(13,15), 10)\n));if(timeOrDate==='time'){output=parsedDate.toLocaleString(\"en-GB\",optionsTime);}else if(timeOrDate==='date'){output=\"\".concat(parsedDate.toLocaleString(\"en-GB\",optionsDate));}else if(timeOrDate==='24'){output=parsedDate.toLocaleString(\"en-GB\",options24);}return output;};_this.lowCarbonLabel=function(item){var output='';// console.log(item.text)\n//if (item.text.split(' ')[0] === 'Low' || item.text.split(' ')[1] === 'Low' ) {\nif(item.text==='Low'||item.text==='Very Low'){output='★';}return output;};_this.formatData=function(){var data=[];var labelData=[];var dayLabels=[];//let middleVal = this.props.middle\n//let middle = this.props.timelineVals[this.props.timelineVals.length-1].level / 2 \nif(_this.props.timelineVals!==[]){_this.props.timelineVals.map(function(item,index){var bar={x:item.level-10,y:-index,label:\"\".concat(_this.lowCarbonLabel(item)),style:{fill:'#00cc66'},yOffset:-25};return data=[].concat(_toConsumableArray(data),[bar]);});_this.props.timelineVals.map(function(item,index){var barLabel={x:0,y:-index,label:\"\".concat(_this.parseDate(item.from,'time')),xOffset:-60};return labelData=[].concat(_toConsumableArray(labelData),[barLabel]);});_this.props.timelineVals.map(function(item,index){// let middle = this.props.screenWidth / 2\n// let middle = this.state.rawData[this.state.rawData-1].x / 2 \n//middle += 100\nvar day='';if(parseInt(\"\".concat(_this.parseDate(item.from,'24')))<1||index<1){day=\"\".concat(_this.parseDate(item.from,'date'));// console.log(day)   \n}var dayLabel={x:_this.state.middle,y:-index,label:day,xOffset:_this.props.mobileUser?0:-30,yOffset:-15};dayLabels=[].concat(_toConsumableArray(dayLabels),[dayLabel]);return null;});}//console.log(data)\n_this.setState({rawData:data,labelData:labelData,dayLabels:dayLabels});};_this.manageHeight=function(){var newHeight=_this.props.timelineVals.length+=400;_this.setState({height:newHeight});};_this._forgetValue=function(){_this.setState({value:null});};_this._rememberValue=function(value){_this.setState({value:value});};_this.colorChange=function(text1,text2,color){if(_this.state.currentLevel.text===text1||_this.state.currentLevel.text===text2){return{color:color,fontWeight:'bold',borderBottom:\"2px solid \".concat(color)};}else return{color:'black',fontWeight:'normal',border:'none'};};return _this;}_createClass(Timeline,[{key:\"componentDidMount\",value:function componentDidMount(){if(typeof this.props.timelineVals[0]!=='undefined'){return this.formatData(),this.manageHeight();}}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps,prevState){if(this.props.scrollPositionY!==prevProps.scrollPositionY){return this.getLevel();}if(this.props.timelineVals!==prevProps.timelineVals)return this.formatData(),this.manageHeight();if(this.state.rawData!==prevState.rawData){return this.scrollPlots();}}},{key:\"render\",value:function render(){//const {value} = this.state\n// let scroll = window.scrollY;\n// console.log(scrolledDown)\n// const highlight = \"highlight\"\nreturn React.createElement(\"div\",null,React.createElement(\"div\",{className:\"bgPanel\"},React.createElement(\"h1\",null,\"Timeline Forecast\"),React.createElement(\"p\",null,\"Use the Forecast Timeline to see the forecast in detail over time.\"),React.createElement(\"p\",null,\"The black line is the Carbon Intensity level. The Carbon Intensity increases as it travels to the right.\"),React.createElement(\"p\",null,\"As you scroll the info panel will update, with the Time, Carbon Intensity Level and Low, Medium, High, indicators.\")),React.createElement(\"div\",{className:\"bgPanel\",style:{background:'#fff'}},React.createElement(\"div\",{style:{height:'800vh'},id:\"bg-fade\"},React.createElement(Dimmer,{active:this.props.loading,page:true},React.createElement(Loader,null,\"Loading\")),React.createElement(\"div\",{id:\"sticky\",height:2},React.createElement(\"h2\",null,\" Carbon Intensity Timeline\"),\" \",React.createElement(\"br\",null),React.createElement(Table,{className:\"sticky-table\",fixed:true,unstackable:true,singleLine:true,celled:true},React.createElement(Table.Body,null,React.createElement(Table.Row,{textAlign:\"center\"},React.createElement(Table.Cell,null,React.createElement(\"h3\",null,this.state.currentLevel.time.slice(8))),React.createElement(Table.Cell,null,React.createElement(\"h3\",null,this.state.currentLevel.time.slice(0,8))),React.createElement(Table.Cell,null,React.createElement(\"h3\",null,\"\".concat(this.state.currentLevel.level,\" CO2e\")))),React.createElement(Table.Row,{textAlign:\"center\"},React.createElement(Table.Cell,null,React.createElement(\"h3\",{style:this.colorChange(\"Low\",\"Very Low\",\"green\")},\"\\u27F5  Low\")),React.createElement(Table.Cell,null,React.createElement(\"h3\",{style:this.colorChange(\"Moderate\",\"Moderate\",\"orange\")},\"Medium\")),React.createElement(Table.Cell,null,React.createElement(\"h3\",{style:this.colorChange(\"High\",\"Very Hight\",\"red\")},\"High  \\u27F6\")))))),React.createElement(\"div\",{id:\"stickyMeasure\"}),React.createElement(\"div\",{id:\"timeline\",height:800,style:{marginBottom:'0vh'}},React.createElement(\"div\",{style:{justifyContent:'space-between',position:'relative',width:'100%',height:'800vh',overflow:'auto'}},React.createElement(\"div\",{style:{width:'100%',height:'100%'}// style={{width: '100%', height: '100%', border: '1px solid #ccc'}}\n},React.createElement(FlexibleXYPlot,{id:\"timeline-chart\",margin:{bottom:250,left:80,right:20,top:50}},React.createElement(HorizontalGridLines,{tickTotal:this.state.rawData.length,animation:true}),React.createElement(LineSeries,{data:this.state.rawData,color:'black',animation:true,style:{fill:'none',strokeLinejoin:'round',strokeWidth:8},curve:'curveMonotoneX'}),React.createElement(LabelSeries,{data:this.state.rawData// labelAnchorX={\"end\"}\n// labelAnchorY={\"middle\"}\n}),React.createElement(LabelSeries,{data:this.state.labelData,labelAnchorX:\"start\",labelAnchorY:\"middle\"}),React.createElement(LabelSeries,{data:this.state.dayLabels,labelAnchorX:\"end\",labelAnchorY:\"middle\"}))))))));}}]);return Timeline;}(Component);export default withScroll(Timeline);","map":{"version":3,"sources":["/Users/Chris/Development/Final-Project/carbon-forecast-frontend/src/components/Timeline.js"],"names":["React","Component","LineSeries","HorizontalGridLines","FlexibleXYPlot","LabelSeries","Table","Dimmer","Loader","withScroll","Timeline","state","rawData","y","x","label","barPosition","date","offset","labelData","lable","height","middle","props","mediumLevel","value","initalScrollCounter","dataIndex","position","scrollPositionY","scrollPlots","getLevel","yOffset","currentLevel","level","time","text","calYOffset","stickyTop","document","querySelector","stickyTopVals","getBoundingClientRect","girdPlotTop","girdPlotTopVals","girdPlotOuterTop","girdPlotOuterTopVals","valA","top","valB","output","setState","chartGap","chartTop","length","setTimeout","gap","timelineVals","map","point","index","data","parseDate","from","currY","newArray","obj","closest","reduce","prev","curr","Math","abs","found","find","input","timeOrDate","optionsDate","weekday","day","month","optionsTime","hour","minute","hour12","options24","parsedDate","Date","UTC","parseInt","slice","toLocaleString","lowCarbonLabel","item","formatData","dayLabels","bar","style","fill","barLabel","xOffset","dayLabel","mobileUser","manageHeight","newHeight","_forgetValue","_rememberValue","colorChange","text1","text2","color","fontWeight","borderBottom","border","prevProps","prevState","background","loading","marginBottom","justifyContent","width","overflow","bottom","left","right","strokeLinejoin","strokeWidth"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport {LineSeries, HorizontalGridLines,  FlexibleXYPlot, LabelSeries} from 'react-vis';\nimport { Table, Dimmer, Loader, } from 'semantic-ui-react';\nimport { withScroll } from 'react-window-decorators';\n\n// @withScroll\nclass Timeline extends Component {\n\n    state = {\n        rawData: [{y: 0, x: 0, label:'loading | loadidng'}],\n        barPosition: {date: '', offset: 0},\n        labelData: [{lable: 'Testing'}],\n        height: 50,\n        middle: typeof this.props.middle !== 'undefined' ? this.props.mediumLevel : 150,\n        value: null,\n       // scrollCount: 0,\n        initalScrollCounter:0,\n        dataIndex: -1,\n        position: this.props.scrollPositionY,\n        scrollPlots: [],\n        getLevel:0,\n        yOffset:0,\n        currentLevel:{level:0, time:'loading', text:'loading'}\n    }\n\n\n\n    componentDidMount () {\n\n\n         if (typeof this.props.timelineVals[0] !== 'undefined'){\n        return (\n            this.formatData(),\n            this.manageHeight()\n              ) \n            }\n        }\n\n        \n        \n        componentDidUpdate (prevProps, prevState) {\n            if (this.props.scrollPositionY !== prevProps.scrollPositionY) {\n               return (this.getLevel() ) \n            }\n            if (this.props.timelineVals !== prevProps.timelineVals)\n            return (\n                this.formatData(),\n                this.manageHeight()\n                ) \n            if (this.state.rawData !== prevState.rawData)\n            {\n               return (this.scrollPlots() )\n            }\n\n            }\n\n\n\ncalYOffset = () => {\n    const stickyTop = document.querySelector('#sticky')\n    let stickyTopVals = stickyTop.getBoundingClientRect()\n    // console.log(stickyTopVals)\n\n    \n    const girdPlotTop = document.querySelector('.rv-xy-plot__grid-lines')\n    let girdPlotTopVals = girdPlotTop.getBoundingClientRect()\n    // console.log(girdPlotTopVals)    \n\n    const girdPlotOuterTop = document.querySelector('.rv-xy-plot__inner')\n    let girdPlotOuterTopVals = girdPlotOuterTop.getBoundingClientRect()\n    // console.log(girdPlotOuterTopVals)\n    \n    let valA = stickyTopVals.top\n    let valB = girdPlotTopVals.top - girdPlotOuterTopVals.top\n    let output = valA+valB-2 //109\n    this.setState({yOffset: output})\n    return output\n}\n\n    chartGap = () => {\n    \n        const chartTop = document.querySelector('.rv-xy-plot__grid-lines')\n       // console.log('clientHeight '+ chartTop.clientHeight )\n       let height = chartTop.getBoundingClientRect()\n    //    console.log(height)\n        let output = (height.height / this.state.rawData.length)\n        // console.log(output)\n        return output\n    }\n    \n\n\n    scrollPlots = () => {\n        setTimeout(() => this.calYOffset(), 300)\n        \n        setTimeout(() => {\n            let gap =this.chartGap()\n        // console.log(gap)\n        let scrollPlots =  this.props.timelineVals.map((point, index) => {    \n        \n        let data = {time:`${this.parseDate(point.from, 'time')} ${this.parseDate(point.from, 'date')}`,\n        y: (gap * index)+(index/2), level: point.level, text: point.text}\n            return data\n        })\n        this.setState({scrollPlots: scrollPlots})\n    },400)\n    }\n   \n\n    getLevel = () => {\n        \n        if (this.state.scrollPlots.length > 1) {\n\n        let currY = this.props.scrollPositionY - this.state.yOffset \n        let newArray = this.state.scrollPlots.map(obj => {\n            return obj.y\n          })\n           let closest = newArray.reduce((prev, curr) => {\n           return (Math.abs(curr - currY) < Math.abs(prev - currY) ? curr : prev);\n           })\n          let found = this.state.scrollPlots.find(obj => {\n            return obj.y === closest\n          })\n         return this.setState({\n              currentLevel:{level: found.level, time:found.time, text:found.text}\n          })\n        }\n          //return found.level \n        \n        }\n\n\n    parseDate = (input, timeOrDate) => {\n        let output = 0\n        let optionsDate = { weekday: 'short', day: 'numeric', month: 'numeric' };\n        let optionsTime = { hour: 'numeric',minute: 'numeric', hour12: true};\n        let options24 = { hour: 'numeric',minute: 'numeric', hour12: false};\n\n               let parsedDate = new Date(Date.UTC(\n                   parseInt(input.slice(0, 4), 10),\n                   parseInt(input.slice(5, 7), 10) - 1,\n                   parseInt(input.slice(8, 10), 10),\n                   parseInt(input.slice(11, 13), 10),\n                   parseInt(input.slice(14, 16), 10),\n                 //parseInt(input.slice(13,15), 10)\n               ))\n               if (timeOrDate === 'time'){\n                   output =  parsedDate.toLocaleString(\"en-GB\", optionsTime)\n               }else if (timeOrDate === 'date') {\n               output =  (`${parsedDate.toLocaleString(\"en-GB\", optionsDate)}`)\n               }else if (timeOrDate === '24') {\n               output =  parsedDate.toLocaleString(\"en-GB\", options24)\n              }\n\n\n            return output\n\n            }\n\n        lowCarbonLabel = (item) => {\n            let output = ''\n            // console.log(item.text)\n            //if (item.text.split(' ')[0] === 'Low' || item.text.split(' ')[1] === 'Low' ) {\n            if (item.text === 'Low' || item.text === 'Very Low' ) {\n                output = '★'\n            }\n            return output\n        }\n\n       formatData = () => {\n        let data = []\n        let labelData = []\n        let dayLabels = []\n        //let middleVal = this.props.middle\n        //let middle = this.props.timelineVals[this.props.timelineVals.length-1].level / 2 \n\n        if (this.props.timelineVals !== [] ) {\n\n        this.props.timelineVals.map((item, index) => {\n            let bar = {x: item.level-10, y: -index, label: `${this.lowCarbonLabel(item)}`,style: {fill: '#00cc66'}, yOffset:-25}   \n          return  data = [...data, bar]\n        })\n\n        this.props.timelineVals.map((item, index) => {\n            let barLabel = {x: 0, y: -index, label: `${this.parseDate(item.from, 'time')}`, xOffset:-60}  \n           return labelData = [...labelData, barLabel]\n        })\n        this.props.timelineVals.map((item, index) => {\n            \n           // let middle = this.props.screenWidth / 2\n           // let middle = this.state.rawData[this.state.rawData-1].x / 2 \n            //middle += 100\n            let day = ''\n\n            if (parseInt(`${this.parseDate(item.from, '24')}`) < 1 || index < 1 )\n            {\n                day = `${this.parseDate(item.from, 'date')}`\n                // console.log(day)   \n            }\n            let dayLabel = {x: this.state.middle, y: -index, \n                label: day,\n                xOffset: this.props.mobileUser ? 0 : -30,\n                 yOffset:-15}  \n            dayLabels = [...dayLabels, dayLabel]\n        \n        return null\n        })\n\n    }\n       \n        //console.log(data)\n        \n        this.setState({\n            rawData: data,\n            labelData: labelData,\n            dayLabels: dayLabels\n        })    \n    \n    }\n    //day.sort((a, b) => (a.level > b.level)\n    manageHeight = () => {\n       let newHeight =  this.props.timelineVals.length += 400\n        this.setState({\n            height: newHeight\n        })\n    }\n\n    _forgetValue = () => {\n        this.setState({\n          value: null\n        });\n      };\n    \n      _rememberValue = value => {\n        this.setState({value});\n      };\n    \n\n\n      \n      \n      colorChange = (text1, text2, color) => {\n        if (this.state.currentLevel.text === text1 || this.state.currentLevel.text === text2) {\n         return {color: color, fontWeight: 'bold', borderBottom: `2px solid ${color}`} \n        }else return {color: 'black', fontWeight: 'normal', border:'none'}\n    }\n      \n    \n\n    \n    render() {\n        //const {value} = this.state\n       // let scroll = window.scrollY;\n        // console.log(scrolledDown)\n       // const highlight = \"highlight\"\n        \n\n\n        return (\n\n<div>\n\n<div className=\"bgPanel\">\n            <h1>Timeline Forecast</h1>\n        <p>Use the Forecast Timeline to see the forecast in detail over time.</p>\n        <p>The black line is the Carbon Intensity level. The Carbon Intensity increases as it travels to the right.</p>\n        <p>As you scroll the info panel will update, with the Time, Carbon Intensity Level and Low, Medium, High, indicators.</p>\n      {/* <Accordion defaultActiveIndex={[]} panels={TitleContent.fuelMixTitle} exclusive={false}/> */}\n      </div>\n\n<div  className=\"bgPanel\" style={{\n   \n                background: '#fff',\n               \n            }}>\n\n            <div\n            \n            style={{\n                height: '800vh',\n                \n            }}\n            id=\"bg-fade\"\n            >\n\n\n\n\n\n<Dimmer active={this.props.loading} page>\n        <Loader>Loading</Loader>\n    </Dimmer>\n\n\n\n          <div id=\"sticky\" height={2}> \n         <h2> Carbon Intensity Timeline</h2> <br></br>\n            {/* Vertical scroll position is: { this.props.scrollPositionY - this.state.yOffset } <br></br> */}\n            {/* Carbon Intensity: {this.state.currentLevel.level} */}\n           \n\n\n\n\n\n\n          <Table className=\"sticky-table\" fixed unstackable singleLine celled>\n          {/* <Table id=\"sticky-table\" fixed unstackable singleLine celled> */}\n\n            <Table.Body>\n            \n            <Table.Row textAlign='center'> \n            <Table.Cell><h3>{this.state.currentLevel.time.slice(8)}</h3></Table.Cell>\n            <Table.Cell><h3>{this.state.currentLevel.time.slice(0,8)}</h3></Table.Cell>\n            <Table.Cell><h3>{`${this.state.currentLevel.level} CO2e`}</h3></Table.Cell>\n            </Table.Row> \n\n            <Table.Row textAlign='center'>\n            <Table.Cell><h3 style={this.colorChange(\"Low\",\"Very Low\", \"green\")}>⟵  Low</h3></Table.Cell>\n            <Table.Cell><h3 style={this.colorChange(\"Moderate\",\"Moderate\", \"orange\")}>Medium</h3></Table.Cell>\n            <Table.Cell><h3 style={this.colorChange(\"High\",\"Very Hight\", \"red\")}>High  ⟶</h3></Table.Cell>\n            </Table.Row>\n            </Table.Body>\n          </Table>\n          \n          </div>\n          <div id=\"stickyMeasure\">\n          </div>\n\n                <div id=\"timeline\" height={800} style={{marginBottom: '0vh'}}>\n<div\n        \n      style={{\n        \n          justifyContent: 'space-between',\n          position: 'relative',\n          width:  '100%',\n          height: '800vh',\n    \n           overflow: 'auto',\n        }}\n      \n\n      \n    >\n\n\n\n<div\n        style={{width: '100%', height: '100%'}}\n        // style={{width: '100%', height: '100%', border: '1px solid #ccc'}}\n      >\n        {/* <FlexibleXYPlot  id=\"timeline-chart\" margin={{bottom: 1000, left: 80, right: 20, top: 50}}>  */}\n        <FlexibleXYPlot  id=\"timeline-chart\" margin={{bottom: 250, left: 80, right: 20, top: 50}}> \n        {/* <FlexibleXYPlot  id=\"timeline-chart\" margin={{bottom: 80, left: 80, right: 20, top: 50}}>  */}\n        {/*50*/}\n        {/* xType=\"time\" \n         yType=\"ordinal\"\n        */}\n        \n\n        <HorizontalGridLines \n        tickTotal={this.state.rawData.length}\n        animation={true}\n        />\n     \n\n        \n        \n        <LineSeries \n        data={this.state.rawData}\n        color={'black'}\n        animation\n        style={{\n            fill: 'none',\n            strokeLinejoin: 'round',\n            strokeWidth: 8\n        }}\n        curve={'curveMonotoneX'}\n        />\n\n\n\n        <LabelSeries\n        data={this.state.rawData}\n        // labelAnchorX={\"end\"}\n        // labelAnchorY={\"middle\"}\n        />\n        <LabelSeries\n        data={this.state.labelData}\n        labelAnchorX={\"start\"}\n        labelAnchorY={\"middle\"}\n        />\n\n        <LabelSeries\n        data={this.state.dayLabels}\n        labelAnchorX={\"end\"}\n        labelAnchorY={\"middle\"}\n        />\n\n\n\n        </FlexibleXYPlot>\n      </div>\n\n</div>\n     \n\n        </div>\n        \n\n            </div></div>\n\n            </div>\n        );\n    }\n}\n\nexport default withScroll (Timeline);\n"]},"metadata":{},"sourceType":"module"}